window.myApp=window.myApp||{},myApp.dashboard=function(e){var t,s="",n=0,i=0,r=Date.now(),p="number"==typeof __refresh?__refresh:300,u="",o=0,l={},h={},c={},g=[],m="",d=!1;function f(){r=Date.now(),s=e("#server-template").html(),l=e("#server-container").html(""),c=e("#server-title").html(""),h=e("#last-update"),c.append('<th style="width:21%"></th>'),c.append('<th style="width:9%">Last 30 days</th>');for(var a=6;a>=0;a--)t=new Date(+new Date-864e5*a),m=t.getMonth()+1+"-"+t.getDate(),c.append('<th style="width:10%">'+m+"</th>");var p=function(){var e=+new Date,t=+(new Date).setHours(0,0,0,0);e=Math.floor(e/1e3),t=Math.floor(t/1e3);var a=[];a.push(e-2592e3+"_"+e),a.push(t-518400+"_"+(t-432e3-1)),a.push(t-432e3+"_"+(t-345600-1)),a.push(t-345600+"_"+(t-259200-1)),a.push(t-259200+"_"+(t-172800-1)),a.push(t-172800+"_"+(t-86400-1)),a.push(t-86400+"_"+(t-0-1)),e===t&&(e+=1);return a.push(t+"_"+e),{ranges:a.join("-"),secondsToday:e-t}}();for(var f in u=p.ranges,o=p.secondsToday,n=0,g=[],d=!1,__apiKeys)y(__apiKeys[f],f);i=setInterval(v,1e3)}function y(t,a){e.post({url:"https://api.uptimerobot.com/v2/getMonitors",data:"api_key="+t+"&custom_uptime_ranges="+u+"&format=json&logs=1&logs_limit=100",dataType:"json",success:function(t){var s=[];for(var i in t.monitors)s.push(w(t.monitors[i]));g[a]={id:a,htmls:s,shown:!1},function(){for(var t=0;t<__apiKeys.length&&null!=g[t];t++)if(!0!==g[t].shown){for(var a in g[t].htmls)l.append(g[t].htmls[a]);g[t].shown=!0,n++}n===__apiKeys.length&&(e(".set-tooltip").tooltip({html:!0}),e("#stattip-load").addClass("hide"),d?(e("#stattip-err").removeClass("hide"),e("#stattip-ok").addClass("hide")):(e("#stattip-ok").removeClass("hide"),e("#stattip-err").addClass("hide")))}()}})}function w(t,n){switch(t.alert="",parseInt(t.status,10)){case 0:case 1:t.statustext="unknown",t.statusicon="question-sign",t.label="default";break;case 2:t.statustext="normal",t.statusicon="ok",t.label="success",t.alert="";break;case 8:t.statustext="abnormal",t.statusicon="exclamation-sign",t.label="warning",t.alert="warning",d=!0;break;case 9:t.statustext="malfunction",t.statusicon="remove",t.label="danger",t.alert="danger",d=!0}var i,r,p,u,l=[],h=1;if(864e5,i=(r=+new Date)-864e5,t.logs.length){for(var c,g,m=i,f=r,y=0;y<t.logs.length;y++){switch((m=1e3*t.logs[y].datetime)<i&&(m=i),g=t.logs[y].type,parseInt(g,10)){case 1:g=1;break;case 2:g=2;break;default:g=0}if(h-=(f-m)/864e5,l.length>0&&l[l.length-1].typeid==g?(l[l.length-1].len+=(f-m)/864e5,l[l.length-1].left=m):l.push({typeid:g,len:(f-m)/864e5,left:m,right:f}),f=m,m<=i)break}if(m>i){switch(parseInt(g,10)){case 1:c=2;break;case 2:c=1;break;default:c=0}l.length>0&&l[l.length-1].typeid==g?(l[l.length-1].len+=h,l[l.length-1].left=i):l.push({typeid:c,len:h,start:i,end:l[l.length-1].left})}}else{var w;switch(parseInt(t.status,10)){case 2:w=2;break;case 8:case 9:w=1;break;default:w=0}l.push({typeid:w,len:1,left:i,right:r})}for(t.progress=[];p=l.pop();)u=""+_(parseInt(p.typeid),!0),1==p.len?u+=" (Nearly 24 hours)":(p.right-p.left<354e4?u+=" ("+new Number((p.right-p.left)/6e4).toFixed(0)+" minute)":u+=" ("+new Number((p.right-p.left)/36e5).toFixed(1)+" hour)",u+='<br><span class="ttime">'+x(p.left)+" ~ "+x(p.right)+"</span>"),t.progress.push({typeid:p.typeid,types:b,len:(100*p.len).toString(),stattip:u});var v,I,M=t.custom_uptime_ranges.split("-"),N=[];for(a=0;a<M.length;a++)v=(I=0===a?(100-M[a])/100*1440*30:7===a?(100-M[a])/100*(o/60):(100-M[a])/100*1440)/60,M[a]>=99.99?N[a]="availability 100%":N[a]=I<60?"availability "+new Number(M[a]).toFixed(2)+"%<br> malfunction "+new Number(I).toFixed(0)+" minutes":"availability "+new Number(M[a]).toFixed(2)+"%<br> malfunction "+new Number(v).toFixed(1)+" hours";return t.charts=[{uptime:M[0],uptimetext:N[0],uptype:k,upsign:D},{uptime:M[1],uptimetext:N[1],uptype:k,upsign:D},{uptime:M[2],uptimetext:N[2],uptype:k,upsign:D},{uptime:M[3],uptimetext:N[3],uptype:k,upsign:D},{uptime:M[4],uptimetext:N[4],uptype:k,upsign:D},{uptime:M[5],uptimetext:N[5],uptype:k,upsign:D},{uptime:M[6],uptimetext:N[6],uptype:k,upsign:D},{uptime:M[7],uptimetext:N[7],uptype:k,upsign:D}],e(Mustache.render(s,t))}function v(){var e=Date.now(),t=parseInt((e-r)/1e3,10),a=Math.floor((p-t)/60),s=p-60*a-t;s=s<10?"0"+s:s,t>p?(clearInterval(i),f()):h.html(a+":"+s)}function b(){switch(parseInt(this.typeid,10)){case 1:return"danger";case 2:return"success";case 99:case 98:default:return"default"}}function _(e,t){switch(e){case 1:return(t?'<span class="glyphicon glyphicon-remove-sign"></span> ':"")+"malfunction";case 2:return(t?'<span class="glyphicon glyphicon-ok-sign"></span> ':"")+"normal";default:return(t?'<span class="glyphicon glyphicon-question-sign"></span> ':"")+"unknown"}}function x(e){return t=new Date(parseInt(e)),m=t.getMonth()+1+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}function k(){var e=this.uptime;return e>=99.99?"success":e>=98?"warning":"danger"}function D(){var e=this.uptime;return e>=99.99?"ok-sign":e>=98?"exclamation-sign":"remove-sign"}return{init:f}}(jQuery);